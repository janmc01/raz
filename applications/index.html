<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>appli â”ƒ RAZ</title>
    <link rel="icon" href="/img/razicon.png">
    <link rel="stylesheet" href="applications.css">
    <link rel="stylesheet" href="/default.css">
    
</head>
<body>
    <div id="header"></div>

    <h1 class="title">Application</h1>

    <section class="apply hidden">
    <h2>fill out the form</h2>

    <form id="applyForm">
        <input id="mcname" type="text" placeholder="Minecraft Name" required>
        <input id="discord" type="text" placeholder="Discord Tag" required>
        <input type="text" id="website" style="display:none">

        <select id="rank" required>
            <option value="">Choose a Rank</option>
            <option>Media Rank</option>
            <option value="Staff">Staff</option>
            <option value="Builder">Builder</option>
            <option value="Developer">Developer</option>
        </select>

        <textarea id="experience" placeholder="Do you have any past staffing experience?" required></textarea>
        <textarea id="reason" placeholder="Why should we choose you?" required></textarea>

        <button type="submit">Submit Application</button>
    </form>
    <p id="formMessage"></p>
    </section>


<script>
  const form = document.getElementById("applyForm");
  const message = document.getElementById("formMessage");

  const startTime = Date.now();

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const data = {
      mcname: form.mcname.value.trim(),
      discord: form.discord.value.trim(),
      rank: form.rank.value,
      experience: form.experience.value.trim(),
      reason: form.reason.value.trim(),
      website: form.website.value,
      startTime: startTime
    };

    try {
      const res = await fetch("http://DEINE-SERVER-IP:3000/apply", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      });

      const result = await res.json();

      if (result.success) {
        message.textContent = "Bewerbung erfolgreich abgeschickt!";
        message.style.color = "green";
        form.reset();
      } else {
        message.textContent = result.error || "Fehler beim Absenden";
        message.style.color = "red";
      }
    } catch (err) {
      message.textContent = "Server nicht erreichbar";
      message.style.color = "red";
    }
  });
</script>

    
    
</body>
</html>

<script>
  fetch("/default.html")
    .then(res => res.text())
    .then(data => {
      document.getElementById("header").innerHTML = data;
    });
</script>


<script>
document.getElementById("applyForm").addEventListener("submit", e => {
  e.preventDefault();

  const data = {
    embeds: [{
      title: "ðŸ“© New Application",
      color: 5793266,
      fields: [
        { name: "Minecraft Name", value: mcname.value, inline: true },
        { name: "Discord", value: discord.value, inline: true },
        { name: "Rank", value: rank.value, inline: true },
        { name: "Experience", value: experience.value },
        { name: "Anything else?", value: anything_else.value }
      ],
      footer: { text: "Made by Jan with ðŸ’–" },
      timestamp: new Date()
    }]
  };

  if (website.value !== "") return;

  fetch("", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(() => {
    alert("Success");
    applyForm.reset();
  })
  .catch(() => alert("Error"));
});
</script>



<script>
const observer = new IntersectionObserver(entries => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add("show");
    }
  });
});

document.querySelectorAll(".hidden").forEach(el => observer.observe(el));
</script>

<script>
let lastSubmit = 0;

document.getElementById("applyForm").addEventListener("submit", e => {
  const now = Date.now();
  if (now - lastSubmit < 60000) {
    alert("Bitte warte 1 Minute vor der nÃ¤chsten Bewerbung.");
    e.preventDefault();
    return;
  }
  lastSubmit = now;
});
</script>


